generator client {
  provider = "prisma-client-js"
  previewFeatures = ["driverAdapters"]
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model User {
  id        Int      @id @default(autoincrement())
  userId    String    @unique @map("user_id")
  name      String?   @db.VarChar(40)
  email     String   @unique @db.VarChar(255)
  password  String 
  role      UserRole? @default(USER)

  carts     Cart[]
  wishlists WishList[]
  orders Order[]
}

model Product{
  id          Int      @id @default(autoincrement())
  productId   String @unique @map("product_id")
  title       String 
  category    String
  description String
  imgUrl      String @map("img_url")

  carts Cart[]
  wishlists WishList[]
}

model Cart {
  id        Int     @id @default(autoincrement())
  userId    String @map("user_id")
  productId String @map("product_id")
  quantity  Int
  addedAt   DateTime @default(now()) @map("added_at")

  user      User    @relation(fields: [userId], references: [userId])
  product   Product @relation(fields: [productId], references: [productId])

  @@unique([userId, productId]) // Prevent duplicate entries
}

model WishList{
  id Int @id @default(autoincrement())
  userId String 
  productId String
  addedAt   DateTime @default(now()) @map("added_at")

  user      User    @relation(fields: [userId], references: [userId])
  product   Product @relation(fields: [productId], references: [productId])
}

model Kyc{
  id Int @id @default(autoincrement())

}

model Order {
  id            Int        @id @default(autoincrement())
  userId        String        // Reference to the User who placed the order
  totalAmount   Float      // Total amount for the order
  status        String     @default("pending") // Order status
  createdAt     DateTime   @default(now()) // Timestamp when the order was created
  updatedAt     DateTime   @updatedAt // Timestamp when the order was last updated
  user          User       @relation(fields: [userId], references: [userId]) // Relationship to User
}

enum UserRole{
  ADMIN
  USER
}

